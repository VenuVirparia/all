gcc server.c –o server
gcc client.c –o client

Execute server program : ./server
Execute client program by passing arguments : (ServerIP, EchoString, PortNo.)
./client 192.168.31.10 Hello 8089

1. TCP concurrent echo server echo client
2. TCP iterative echo server echo client
3. UDP echo
4. UDP date & time
---------------------------------------------------------------------------
tcpclient.c

#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <stdlib.h>
#include <netinet/in.h>
#include <string.h>
#define MAXLINESIZE 100
#define SERV_PORT 5555

int main(int argc,char** argv){

int connectsd;
char sendBuffer[MAXLINESIZE+1];
char recvBuffer[MAXLINESIZE+1];
struct sockaddr_in servaddr;
int noBytesRead=0;

if(argc!=2){
fprintf(stderr,"Usage: %s IP-Address\n",argv[0]);
exit(-1);
}

/* Create socket */
if((connectsd=socket(AF_INET, SOCK_STREAM, 0))<0){
fprintf(stderr,"Cannot create socket\n");
exit(-1);
}

/* Initialize socket address structure */
bzero(&servaddr,sizeof(servaddr));
servaddr.sin_family=AF_INET;
servaddr.sin_port=htons(SERV_PORT);

/*assign server address in socket address structure*/
if(inet_pton(PF_INET,argv[1],&servaddr.sin_addr)<=0){
fprintf(stderr,"Error in inet_pton\n");
exit(-1);
}

/*Get connected with the server*/
if(connect(connectsd,(struct sockaddr*)&servaddr,sizeof(servaddr))<0){
fprintf(stderr,"Error in connect\n");
exit(-1);
}

/* Read message from user through keyboard */
for(;gets(sendBuffer)!=NULL;){

/* Send the message to the server */
write(connectsd,sendBuffer,strlen(sendBuffer)+1);

if(noBytesRead=read(connectsd,recvBuffer,sizeof(recvBuffer))<0)
exit(0);

/*Display what the server sent in reply */
fprintf(stdout,"%s\n",recvBuffer);
}
return 0;
}
--------------------------------
tcp concurrent server.c
/*This server program is concurrent*/

#include <sys/types.h>
#include <sys/socket.h>
#include <stdio.h>
#include <stdlib.h>
#include <netinet/in.h>
#define MAXLINESIZE 100
#define SERV_PORT 5555
int listensd,clientsd;
char buffer[MAXLINESIZE+1];
struct sockaddr_in servaddr;
int noBytesRead=0;
/*this function will server client that connects*/
void processClient(int);

int main(){

/*Create socket*/
if((listensd=socket(AF_INET,SOCK_STREAM,0))<0){
fprintf(stderr,"Cannot create socket\n");
exit(-1);
}

/*initialize socket address structure*/
bzero(&servaddr,sizeof(servaddr));
servaddr.sin_family=AF_INET;
servaddr.sin_port=htons(SERV_PORT);
servaddr.sin_addr.s_addr=htonl(INADDR_ANY);

/*bind socket address to the socket*/

if(bind(listensd,(struct sockaddr*)&servaddr,sizeof(servaddr))<0){
fprintf(stderr,"Error in bind\n");
exit(-1);
}

/*Make the socket listeningsocket*/

if(listen(listensd,2)<0){
fprintf(stderr,"Error in listen\n");
exit(-1);
}

for(;;){
/*wait for client connection*/
clientsd=accept(listensd,(struct sockaddr*)NULL,NULL);
if(fork()==0){
/*close listening socket in child. So that reference count
remains one. The child serves the client. It does not need listening socket
to do this. */
close(listensd);
/*server client*/
processClient(clientsd);
/*close connected socket*/
close(clientsd);
exit(0);
}

/*close connected socket in parent so that reference count remains one.*/

close(clientsd);
}
return 0;
}
void processClient(int clientsd){
/*read message from client and send back*/

while((noBytesRead=read(clientsd,buffer,sizeof(buffer)))>0)
write(clientsd,buffer,noBytesRead);
}

--------------------------------------------------------
------------------------------------------------------
tcp client.c
#include <stdlib.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <string.h>
#include <arpa/inet.h>


#define MAXLINE 4096 /*max text line length*/
#define SERV_PORT 3000 /*port*/

int
main(int argc, char **argv) 
{
 int sockfd;
 struct sockaddr_in servaddr;
 char sendline[MAXLINE], recvline[MAXLINE];
	
 //basic check of the arguments
 //additional checks can be inserted
 if (argc !=2) {
  perror("Usage: TCPClient <IP address of the server"); 
  exit(1);
 }
	
 //Create a socket for the client
 //If sockfd<0 there was an error in the creation of the socket
 if ((sockfd = socket (AF_INET, SOCK_STREAM, 0)) <0) {
  perror("Problem in creating the socket");
  exit(2);
 }
	
 //Creation of the socket
 memset(&servaddr, 0, sizeof(servaddr));
 servaddr.sin_family = AF_INET;
 servaddr.sin_addr.s_addr= inet_addr(argv[1]);
 servaddr.sin_port =  htons(SERV_PORT); //convert to big-endian order
	
 //Connection of the client to the socket 
 if (connect(sockfd, (struct sockaddr *) &servaddr, sizeof(servaddr))<0) {
  perror("Problem in connecting to the server");
  exit(3);
 }
	
 while (fgets(sendline, MAXLINE, stdin) != NULL) {
	
  send(sockfd, sendline, strlen(sendline), 0);
		
  if (recv(sockfd, recvline, MAXLINE,0) == 0){
   //error: server terminated prematurely
   perror("The server terminated prematurely"); 
   exit(4);
  }
  printf("%s", "String received from the server: ");
  fputs(recvline, stdout);
 }

 exit(0);
}
------------------------------
tcp server.c
#include <stdlib.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <string.h>
#include <unistd.h>

#define MAXLINE 4096 /*max text line length*/
#define SERV_PORT 3000 /*port*/
#define LISTENQ 8 /*maximum number of client connections */

int main (int argc, char **argv)
{
 int listenfd, connfd, n;
 socklen_t clilen;
 char buf[MAXLINE];
 struct sockaddr_in cliaddr, servaddr;

 //creation of the socket 
 listenfd = socket (AF_INET, SOCK_STREAM, 0);

 //preparation of the socket address
 servaddr.sin_family = AF_INET;
 servaddr.sin_addr.s_addr = htonl(INADDR_ANY);
 servaddr.sin_port = htons(SERV_PORT);

 bind (listenfd, (struct sockaddr *) &servaddr, sizeof(servaddr));

 listen (listenfd, LISTENQ);

 printf("%s\n","Server running...waiting for connections.");

 for ( ; ; ) {

  clilen = sizeof(cliaddr);
  connfd = accept (listenfd, (struct sockaddr *) &cliaddr, &clilen);
  printf("%s\n","Received request...");

  while ( (n = recv(connfd, buf, MAXLINE,0)) > 0)  {
   printf("%s","String received from and resent to the client:");
   puts(buf);
   send(connfd, buf, n, 0);
  }

 if (n < 0) {
  perror("Read error");
  exit(1);
 }
 close(connfd);

 }
 //close listening socket
 close (listenfd);
}
------------------------------------------------------
-----------------------------------------------------
Udp client.c
#include<sys/types.h>
#include<sys/socket.h>
#include<netinet/in.h>
#include<stdio.h>
#define MAXLINE 100
#define SERV_PORT 8000

int main(int argc,char** argv)
{
	int sockfd;
	struct sockaddr_in servaddr;
	int n;
	char sendline[MAXLINE],recvline[MAXLINE];

	if(argc!=2)
	{
		fprintf(stderr,"Usage:%s IP-Address\n",argv[0]);
		exit(-1);
	}
	
	/*Initialize socket address structure*/
	bzero(&servaddr,sizeof(servaddr));
    	servaddr.sin_family=AF_INET;

	if(inet_pton(AF_INET,argv[1],&servaddr.sin_addr)<0)
	{
		fprintf(stderr,"Error in inet_pton\n");
	}

	servaddr.sin_port=htons(SERV_PORT);

	/*Create socket*/
	sockfd=socket(AF_INET,SOCK_DGRAM,0);
	
	while(fgets(sendline,MAXLINE,stdin)!=NULL)
	{
		/*Send the message to the server*/
		sendto(sockfd,sendline,strlen(sendline),0,(struct sockaddr*)&servaddr,sizeof(servaddr));
		/*wait for response and receive the response*/
		n=recvfrom(sockfd,recvline,MAXLINE,0,NULL,NULL);
		recvline[n]=0;
		/*Display what the server sent in reply*/
		fputs(recvline,stdout);
	}	


}
------------------------------------
udp server.c
#include<sys/types.h>
#include<sys/socket.h>
#include<netinet/in.h>
#include<stdio.h>
#define MAXLINESIZE 100
#define SERV_PORT 8000

int main(int argc,char** argv)
{
	int sockfd;
	struct sockaddr_in servaddr,cliaddr;
	int n;
	socklen_t len;
	char mesg[MAXLINESIZE];
	
	/*Create socket*/
	sockfd=socket(AF_INET,SOCK_DGRAM,0);
			
	/*Initialize socket address structure*/
	bzero(&servaddr,sizeof(servaddr));
    	servaddr.sin_family=AF_INET;
	servaddr.sin_port=htons(SERV_PORT);

	/*bind socket address to the socket*/
	bind(sockfd,(struct sockaddr*)&servaddr,sizeof(servaddr));
	
	for(;;)
	{
		len=sizeof(cliaddr);
		/*wait for datagram to arrive,receive a datagram*/
		n=recvfrom(sockfd,mesg,MAXLINESIZE,0,(struct sockaddr*)&cliaddr,&len);
		/*send back the datagram to the client from which it arrived*/
		sendto(sockfd,mesg,n,0,(struct sockaddr*)&cliaddr,len);
	}	


}
------------------------------------------
-----------------------------------------
udp date&time serer.c
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <stdio.h>
#include <string.h>
#include <time.h>
#include <stdlib.h>

#define MAXLINESIZE 100
#define SERV_PORT 8000

int main()
{
    int sockfd;
    struct sockaddr_in servaddr, cliaddr;
    int n;
    socklen_t len;
    char mesg[MAXLINESIZE];

    /* Create socket */
    sockfd = socket(AF_INET, SOCK_DGRAM, 0);

    /* Initialize socket address structure */
    bzero(&servaddr, sizeof(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_addr.s_addr = htonl(INADDR_ANY);   // Important
    servaddr.sin_port = htons(SERV_PORT);

    /* Bind socket */
    bind(sockfd, (struct sockaddr *)&servaddr, sizeof(servaddr));

    printf("UDP Server Running... Waiting for messages...\n");

    for(;;)
    {
        len = sizeof(cliaddr);

        /* Wait for datagram */
        n = recvfrom(sockfd, mesg, MAXLINESIZE, 0,
                     (struct sockaddr *)&cliaddr, &len);

        mesg[n] = '\0';
        printf("Received from client: %s\n", mesg);

        /* Prepare date & time string */
        time_t t = time(NULL);
        char *dt = ctime(&t);     // already newline terminated

        /* Send date & time back to client */
        sendto(sockfd, dt, strlen(dt), 0,
               (struct sockaddr *)&cliaddr, len);
    }
}

-------------------------------
udp client
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <arpa/inet.h>

#define MAXLINE 100
#define SERV_PORT 8000

int main(int argc, char **argv)
{
    int sockfd;
    struct sockaddr_in servaddr;
    int n;
    char sendline[MAXLINE], recvline[MAXLINE];

    if (argc != 2)
    {
        fprintf(stderr, "Usage: %s <Server-IP>\n", argv[0]);
        exit(1);
    }

    /* Initialize server address */
    bzero(&servaddr, sizeof(servaddr));
    servaddr.sin_family = AF_INET;

    if (inet_pton(AF_INET, argv[1], &servaddr.sin_addr) <= 0)
    {
        fprintf(stderr, "Invalid IP address\n");
        exit(1);
    }

    servaddr.sin_port = htons(SERV_PORT);

    /* Create UDP socket */
    sockfd = socket(AF_INET, SOCK_DGRAM, 0);

    printf("Enter any text to request date & time from server:\n");

    while (fgets(sendline, MAXLINE, stdin) != NULL)
    {
        /* Send message to server */
        sendto(sockfd, sendline, strlen(sendline), 0,
               (struct sockaddr *)&servaddr, sizeof(servaddr));

        /* Receive reply (date & time) */
        n = recvfrom(sockfd, recvline, MAXLINE, 0, NULL, NULL);

        recvline[n] = '\0';
        printf("Server Date & Time: %s\n", recvline);
    }

    return 0;
}
-------------------------
How to Run
1. Compile
gcc udp_server_datetime.c -o server
gcc udp_client_datetime.c -o client

2. Run Server
./server

3. Run Client (in another terminal)
./client 127.0.0.1
